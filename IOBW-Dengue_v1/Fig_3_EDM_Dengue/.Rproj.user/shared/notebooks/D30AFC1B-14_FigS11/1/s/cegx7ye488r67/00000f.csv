"0","library(dplyr)"
"0",""
"0","ccm_all <- read.csv(""01_data/02_output/01_CCM_single_rho.csv"")"
"0","country_vars <- unique(ccm_all$country)"
"0","climate_vars <- c(""t2m"",""tp"",""rh"",""svpd"")"
"0","ccm_all <- ccm_all%>% "
"0","  filter(climate %in% climate_vars)"
"0",""
"0","ccm_obs <- subset(ccm_all, method == ""observed"" & LibSize == 60)"
"0","ccm_sea <- subset(ccm_all, method == ""seasonal"" & LibSize == 60)"
"0","ccm_ebi <- subset(ccm_all, method == ""ebisuzaki"" & LibSize == 60)"
"0",""
"0",""
"0","for (i in 1:length(climate_vars)) {"
"0","  for (j in 1:length(country_vars)) {"
"0","    obs <- subset(ccm_obs, climate == climate_vars[i] & country == country_vars[j])"
"0","    sea <- subset(ccm_sea, climate == climate_vars[i] & country == country_vars[j])"
"0","    ebi <- subset(ccm_ebi, climate == climate_vars[i] & country == country_vars[j])"
"0","    "
"0","    t.p_obs.sea <- t.test(sea$rho, mu = obs$rho, alternative = ""less"")[[""p.value""]]"
"0","    t.p_obs.ebi <- t.test(ebi$rho, mu = obs$rho, alternative = ""less"")[[""p.value""]]"
"0",""
"0","    ccm_obs$t.p_sea[ccm_obs$climate == climate_vars[i] & ccm_obs$country == country_vars[j]] <- t.p_obs.sea"
"0","    ccm_obs$t.p_ebi[ccm_obs$climate == climate_vars[i] & ccm_obs$country == country_vars[j]] <- t.p_obs.ebi"
"0","  }"
"0","  "
"0","  t.p_sea <-  ccm_obs$t.p_sea[ccm_obs$climate == climate_vars[i]]"
"0","  t.p_ebi <-  ccm_obs$t.p_ebi[ccm_obs$climate == climate_vars[i]]"
"0","  "
"0","  # Fisher's method"
"0","  fisher_combined_t.p_sea <- -2 * sum(log(t.p_sea))"
"0","  fisher_t.p_sea <- 1 - pchisq(fisher_combined_t.p_sea, df = 2 * length(fisher_combined_t.p_sea))"
"0",""
"0","  fisher_combined_t.p_ebi <- -2 * sum(log(t.p_ebi))"
"0","  fisher_t.p_ebi <- 1 - pchisq(fisher_combined_t.p_ebi, df = 2 * length(fisher_combined_t.p_ebi))"
"0"," "
"0","  ccm_obs$fisher_t.p_sea[ccm_obs$climate == climate_vars[i]] <- fisher_t.p_sea"
"0","  ccm_obs$fisher_t.p_ebi[ccm_obs$climate == climate_vars[i]] <- fisher_t.p_ebi"
"0",""
"0","}"
"0",""
"0","  t.p_sea <-  ccm_obs$t.p_sea"
"0","  t.p_ebi <-  ccm_obs$t.p_ebi"
"0","  "
"0","  t.p<-c(t.p_sea ,t.p_ebi) "
"0","  "
"0","  #BH method"
"0","  t.p_BH<-p.adjust(t.p,method=""BH"")"
"0","  t.p_sea_BH <-t.p_BH[1:96]"
"0","  t.p_ebi_BH <-t.p_BH[97:192]"
"0","  t.p_sea_df <- cbind(data.frame(t.p_sea_BH),ccm_obs$climate)"
"0","  t.p_ebi_df <- cbind(data.frame(t.p_ebi_BH),ccm_obs$climate)"
"0",""
"0","  ccm_obs$t.p_sea_BH <-t.p_sea_BH"
"0","  ccm_obs$t.p_ebi_BH <-t.p_ebi_BH"
"0","  ccm_obs$sign_sea_BH <- ifelse(t.p_sea_BH < 0.05 , 1, 0)"
"0","  ccm_obs$sign_ebi_BH <- ifelse(t.p_ebi_BH < 0.05 , 1, 0)"
"0","  "
